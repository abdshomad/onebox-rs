```mermaid
graph TD
    A[Data Packet Arrives (Seq=S)] --> B{Insert (S, Packet) into <br> BTreeMap Jitter Buffer};
    B --> C{Is this the first ever <br> packet from this client?};
    C -- Yes --> D[Set next_expected_seq = S];
    C -- No --> E;
    D --> E{Loop while buffer contains <br> packet with Seq == next_expected_seq};

    E -- True --> F[Remove packet from buffer];
    F --> G[Write packet to TUN interface];
    G --> H[Increment next_expected_seq];
    H --> E;

    E -- False --> I[Wait for more packets];
```
